Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6

PS C:\malware> Trace-Command -Name metadata, parameterbinding, cmdlet -Expression {. "C:\Users\puma-4\Downloads\PoshC2-master\PoshC2-master\resources\modules\Set-LHSTokenPrivilege.ps1";Set-LHSTokenPrivilege -Privilege SeRestorePrivilege;} -PSHost;
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeAssignPrimaryTokenPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: 
SeAssignPrimaryTokenPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeAssignPrimaryTokenPrivilege] to param [Privilege] 
SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:00:21
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:00:21
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Import-Module]
DEBUG: ParameterBinding Information: 0 :     BIND arg 
[C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules\Microsoft.PowerShell.Management\Microsoft.PowerShell.Management.psd
1] to parameter [Name]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.String to 
System.String[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Name: argument type [String], 
parameter type [System.String[]], collection type Array, element type [System.String], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.String] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type String is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type String to array position 0
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.String[]] to param [Name] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [GLOBAL] to parameter [Scope]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [GLOBAL] to param [Scope] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Boolean to 
System.Management.Automation.SwitchParameter
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [Ignore] to parameter [ErrorAction]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.ActionPreference]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [Ignore] to param [ErrorAction] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [Ignore] to parameter [WarningAction]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.ActionPreference]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [Ignore] to param [WarningAction] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [Ignore] to parameter [InformationAction]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.ActionPreference]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [Ignore] to param [InformationAction] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Verbose]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Boolean to 
System.Management.Automation.SwitchParameter
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Verbose] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Debug]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Boolean to 
System.Management.Automation.SwitchParameter
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Debug] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Import-Module]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Import-Module]
Time-Tracker 2023-07-17 18:00:24
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:00:26
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:00:27
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:00:27
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:00:28

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:00:28
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:00:34
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:00:34
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:00:34
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:00:35

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:00:35
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:00:54
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:00:54
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:00:54
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:00:55

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:00:55
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeAuditPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeAuditPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeAuditPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:00:55
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:00:55
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:00:56
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:00:56
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:00:56
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:00:57

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:00:57
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:01:00
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:00
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:00
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:01

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:01
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:01:01
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:01
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:01
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:02

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:02
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeBackupPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeBackupPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeBackupPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:01:02
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:01:03
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:01:04
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:04
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:04
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:05

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:05
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:01:07
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:08
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:08
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:09

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:09
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:01:09
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:09
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:09
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:10

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:10
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeChangeNotifyPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeChangeNotifyPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeChangeNotifyPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:01:10
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:01:11
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:01:11
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:11
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:11
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:12

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:12
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:01:15
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:15
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:15
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:16

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:16
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:01:16
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:16
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:16
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:17

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:17
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeCreateGlobalPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeCreateGlobalPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeCreateGlobalPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:01:18
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:01:18
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:01:19
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:19
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:19
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:20

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:20
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:01:23
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:23
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:23
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:24

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:24
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:01:24
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:24
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:24
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:25

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:25
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeCreatePagefilePrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeCreatePagefilePrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeCreatePagefilePrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:01:25
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:01:26
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:01:26
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:26
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:26
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:27

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:27
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:01:30
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:30
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:30
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:31

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:31
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:01:31
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:31
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:31
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:32

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:32
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeCreatePermanentPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeCreatePermanentPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeCreatePermanentPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:01:33
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:01:33
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:01:34
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:34
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:34
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:35

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:35
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:01:37
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:37
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:37
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:38

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:38
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:01:38
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:39
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:39
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:40

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:40
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeCreateSymbolicLinkPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: 
SeCreateSymbolicLinkPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeCreateSymbolicLinkPrivilege] to param [Privilege] 
SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:01:40
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:01:40
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:01:41
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:41
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:41
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:42

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:42
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:01:45
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:45
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:45
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:46

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:46
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:01:46
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:46
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:46
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:47

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:47
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeCreateTokenPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeCreateTokenPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeCreateTokenPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:01:47
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:01:48
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:01:48
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:48
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:48
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:49

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:49
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:01:52
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:52
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:52
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:53

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:53
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:01:53
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:53
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:53
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:54

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:54
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeDebugPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeDebugPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeDebugPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:01:55
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:01:55
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:01:56
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:01:56
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:01:56
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:01:57

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:01:57
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:02:00
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:00
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:00
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:01

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:01
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:02:01
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:01
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:01
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:02

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:02
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeEnableDelegationPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeEnableDelegationPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeEnableDelegationPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:02:02
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:02:03
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:02:03
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:03
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:03
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:04

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:04
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:02:07
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:08
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:08
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:09

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:09
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:02:09
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:09
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:09
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:10

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:10
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeImpersonatePrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeImpersonatePrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeImpersonatePrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:02:10
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:02:11
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:02:11
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:11
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:11
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:12

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:12
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:02:15
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:15
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:15
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:16

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:16
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:02:16
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:16
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:16
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:17

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:17
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeIncreaseBasePriorityPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: 
SeIncreaseBasePriorityPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeIncreaseBasePriorityPrivilege] to param [Privilege] 
SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:02:17
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:02:18
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:02:18
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:18
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:18
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:19

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:19
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:02:22
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:22
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:22
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:23

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:23
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:02:24
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:24
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:24
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:25

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:25
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeIncreaseQuotaPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeIncreaseQuotaPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeIncreaseQuotaPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:02:25
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:02:25
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:02:26
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:26
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:26
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:27

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:27
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:02:30
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:30
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:30
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:31

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:31
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:02:31
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:31
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:31
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:32

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:32
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeIncreaseWorkingSetPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: 
SeIncreaseWorkingSetPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeIncreaseWorkingSetPrivilege] to param [Privilege] 
SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:02:32
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:02:33
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:02:33
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:33
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:33
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:34

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:34
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:02:37
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:37
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:37
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:38

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:38
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:02:38
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:38
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:38
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:39

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:39
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeLoadDriverPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeLoadDriverPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeLoadDriverPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:02:39
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:02:40
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:02:40
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:40
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:40
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:41

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:41
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:02:44
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:44
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:44
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:45

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:45
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:02:45
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:45
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:45
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:46

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:46
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeLockMemoryPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeLockMemoryPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeLockMemoryPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:02:46
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:02:47
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:02:47
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:48
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:48
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:49

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:49
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:02:51
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:51
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:51
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:52

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:52
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:02:53
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:53
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:53
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:54

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:54
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeMachineAccountPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeMachineAccountPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeMachineAccountPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:02:54
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:02:54
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:02:55
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:55
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:55
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:02:56

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:02:56
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:02:59
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:02:59
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:02:59
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:00

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:00
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:03:00
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:00
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:00
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:01

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:01
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeManageVolumePrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeManageVolumePrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeManageVolumePrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:03:01
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:03:02
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:03:02
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:02
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:02
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:03

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:03
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:03:06
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:06
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:06
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:07

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:07
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:03:08
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:08
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:08
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:09

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:09
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeProfileSingleProcessPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: 
SeProfileSingleProcessPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeProfileSingleProcessPrivilege] to param [Privilege] 
SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:03:09
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:03:10
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:03:10
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:10
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:10
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:11

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:11
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:03:14
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:14
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:14
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:15

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:15
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:03:15
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:15
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:15
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:16

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:16
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeRelabelPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeRelabelPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeRelabelPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:03:16
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:03:17
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:03:17
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:17
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:17
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:19

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:19
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:03:21
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:22
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:22
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:23

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:23
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:03:23
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:23
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:23
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:24

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:24
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeRemoteShutdownPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeRemoteShutdownPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeRemoteShutdownPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:03:24
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:03:25
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:03:25
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:25
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:25
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:26

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:26
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:03:29
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:29
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:29
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:30

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:30
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:03:30
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:30
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:30
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:31

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:31
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeRestorePrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeRestorePrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeRestorePrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:03:31
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:03:32
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:03:33
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:33
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:33
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:34

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:34
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:03:36
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:36
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:36
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:37

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:37
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:03:38
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:38
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:38
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:39

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:39
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeSecurityPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeSecurityPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeSecurityPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:03:39
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:03:39
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:03:40
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:40
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:40
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:41

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:41
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:03:44
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:44
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:44
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:45

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:45
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:03:45
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:45
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:45
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:46

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:46
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeShutdownPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeShutdownPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeShutdownPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:03:46
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:03:47
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:03:47
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:47
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:47
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:48

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:48
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:03:51
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:51
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:51
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:52

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:52
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:03:52
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:52
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:52
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:53

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:53
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeSyncAgentPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeSyncAgentPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeSyncAgentPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:03:54
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:03:54
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:03:55
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:55
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:55
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:03:56

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:03:56
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:03:59
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:03:59
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:03:59
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:00

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:00
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:04:00
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:00
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:00
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:01

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:01
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeSystemEnvironmentPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeSystemEnvironmentPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeSystemEnvironmentPrivilege] to param [Privilege] 
SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:04:01
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:04:02
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:04:02
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:02
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:02
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:03

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:03
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:04:06
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:06
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:06
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:07

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:07
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:04:08
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:08
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:08
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:09

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:09
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeSystemProfilePrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeSystemProfilePrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeSystemProfilePrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:04:09
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:04:10
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:04:10
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:10
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:10
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:11

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:11
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:04:14
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:14
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:14
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:15

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:15
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:04:15
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:15
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:15
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:16

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:16
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeSystemtimePrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeSystemtimePrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeSystemtimePrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:04:16
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:04:17
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:04:18
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:18
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:18
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:19

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:19
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:04:21
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:22
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:22
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:23

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:23
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:04:23
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:23
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:23
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:24

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:24
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeTakeOwnershipPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeTakeOwnershipPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeTakeOwnershipPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:04:24
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:04:25
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:04:25
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:25
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:25
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:26

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:26
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:04:29
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:29
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:29
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:30

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:30
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:04:30
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:30
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:30
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:31

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:31
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeTcbPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeTcbPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeTcbPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:04:31
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:04:32
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:04:33
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:33
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:33
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:34

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:34
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:04:36
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:37
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:37
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:38

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:38
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:04:38
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:38
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:38
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:39

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:39
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeTimeZonePrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeTimeZonePrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeTimeZonePrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:04:39
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:04:40
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:04:40
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:40
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:40
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:41

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:41
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:04:44
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:44
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:44
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:45

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:45
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:04:45
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:45
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:45
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:46

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:46
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeTrustedCredManAccessPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: 
SeTrustedCredManAccessPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeTrustedCredManAccessPrivilege] to param [Privilege] 
SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:04:46
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:04:47
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:04:47
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:47
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:47
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:48

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:48
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:04:51
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:51
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:51
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:52

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:52
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:04:53
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:53
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:53
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:54

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:54
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeUndockPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeUndockPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeUndockPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:04:54
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:04:55
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:04:55
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:55
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:55
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:04:56

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:04:56
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:04:59
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:04:59
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:04:59
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:05:00

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:05:00
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:05:00
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:05:00
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:05:00
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:05:01

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:05:01
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeUnsolicitedInputPrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeUnsolicitedInputPrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeUnsolicitedInputPrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:05:02
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:05:02
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:05:03
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:05:03
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:05:03
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:05:04

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:05:04
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to parameter [TypeDefinition]
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateTrustedDataAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
   public int Attr;
  }
  
  internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
  internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
  internal const int TOKEN_QUERY = 0x00000008;
  internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

  public static bool EnablePrivilege(long processHandle, string privilege, bool disable)
  {
   bool retVal;
   TokPriv1Luid tp;
   IntPtr hproc = new IntPtr(processHandle);
   IntPtr htok = IntPtr.Zero;
   retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
   tp.Count = 1;
   tp.Luid = 0;
   if(disable)
   {
    tp.Attr = SE_PRIVILEGE_DISABLED;
   }
   else
   {
    tp.Attr = SE_PRIVILEGE_ENABLED;
   }
   retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
   retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
   return retVal;
  }
 }] to param [TypeDefinition] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Add-Type]
Time-Tracker 2023-07-17 18:05:06
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:05:06
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:05:06
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:05:07

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:05:07
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Write-Verbose]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Function Set-LHSTokenPrivilege finished.] to parameter 
[Message]
DEBUG: ParameterBinding Information: 0 :             BIND arg [Function Set-LHSTokenPrivilege finished.] to param 
[Message] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Write-Verbose]
Time-Tracker 2023-07-17 18:05:08
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:05:08
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:05:08
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:05:09

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:05:09
DEBUG: ParameterBinding Information: 0 :     BIND arg [SeRestorePrivilege] to parameter [Privilege]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: SeRestorePrivilege
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.String]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         Executing VALIDATION metadata: 
[System.Management.Automation.ValidateSetAttribute]
DEBUG: ParameterBinding Information: 0 :         BIND arg [SeRestorePrivilege] to param [Privilege] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Set-LHSTokenPrivilege]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Set-LHSTokenPrivilege]
Time-Tracker 2023-07-17 18:05:09
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [ProcessId]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2156] to param [ProcessId] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND arg [False] to parameter [Disable]
DEBUG: ParameterBinding Information: 0 :         Executing DATA GENERATION metadata: 
[System.Management.Automation.ArgumentTypeConverterAttribute]
DEBUG: ParameterBinding Information: 0 :             result returned from DATA GENERATION: False
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [False] to param [Disable] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     BIND NAMED cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :         BIND arg [Latest] to parameter [Version]
DEBUG: ParameterBinding Information: 0 :             Executing DATA GENERATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ArgumentToVersionTransformationAttribute]
DEBUG: ParameterBinding Information: 0 :                 result returned from DATA GENERATION: 5.1.19041.2673
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Version]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Executing VALIDATION metadata: 
[Microsoft.PowerShell.Commands.SetStrictModeCommand+ValidateVersionAttribute]
DEBUG: ParameterBinding Information: 0 :             BIND arg [5.1.19041.2673] to param [Version] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 :     BIND POSITIONAL cmd line args [Set-StrictMode]
DEBUG: ParameterBinding Information: 0 :     MANDATORY PARAMETER CHECK on cmdlet [Set-StrictMode]
Time-Tracker 2023-07-17 18:05:10
DEBUG: ParameterBinding Information: 0 :     CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 :     CALLING EndProcessing
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2156] to parameter [Id]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Int32[]]
DEBUG: ParameterBinding Information: 0 :             Trying to convert argument value from System.Int32 to 
System.Int32[]
DEBUG: ParameterBinding Information: 0 :             ENCODING arg into collection
DEBUG: ParameterBinding Information: 0 :             Binding collection parameter Id: argument type [Int32], parameter 
type [System.Int32[]], collection type Array, element type [System.Int32], coerceElementType
DEBUG: ParameterBinding Information: 0 :             Creating array with element type [System.Int32] and 1 elements
DEBUG: ParameterBinding Information: 0 :             Argument type Int32 is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :             COERCE arg to [System.Int32]
DEBUG: ParameterBinding Information: 0 :                 Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :             Adding scalar element of type Int32 to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.Int32[]] to param [Id] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Get-Process]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Get-Process]
Time-Tracker 2023-07-17 18:05:10
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing

*SUSPENDED the spawned-powershell-process 2156 due to: 'DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing
'

Time-Tracker 2023-07-17 18:05:10
sleep now : for 1 seconds
Time-Tracker 2023-07-17 18:05:10
wake up now : as 1 seconds past
Time-Tracker 2023-07-17 18:05:11

*RESUMED the spwaned-powershell-process 2156

Time-Tracker 2023-07-17 18:05:11
DEBUG: ParameterBinding Information: 0 :     BIND arg [True] to parameter [PassThru]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Management.Automation.SwitchParameter]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [True] to param [PassThru] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Add-Type]
DEBUG: ParameterBinding Information: 0 :     BIND arg [ using System;
 using System.Runtime.InteropServices;
  
 public class AdjPriv
 {
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr 
prev, IntPtr relen);
  
  [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
  internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

  [DllImport("advapi32.dll", SetLastError = true)]
  internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

  [StructLayout(LayoutKind.Sequential, Pack = 1)]
  internal struct TokPriv1Luid
  {
   public int Count;
   public long Luid;
spawned_psh_process -- Ended before 1 hr ; with NO exception raised
